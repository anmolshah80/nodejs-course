<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('./partials/head') %>
    <title>Sign Up | LongBloom</title>

    <style>
      .sign-in-link {
        text-decoration: none;
      }

      .sign-in-link:hover {
        text-decoration: underline;
      }

      .row > * {
        padding-inline: 0;
      }

      @media (min-width: 320px) {
        .error-message {
          color: oklch(63.7% 0.237 25.331);
          font-size: 0.9rem;
          font-weight: bold;
          margin-block: 0.25rem 0;
        }

        .password-format {
          color: oklch(37.2% 0.044 257.287);
          display: flex;
          flex-direction: column;
          justify-content: center;
          margin-block: 1rem 0;
        }
      }

      @media (min-width: 768px) {
        .error-message {
          font-size: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <%- include('./partials/nav') %>

    <section
      style="
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1.25rem;
        flex-direction: column;
        padding: 1.5rem 1rem;
      "
    >
      <div
        style="
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          gap: 1rem;
        "
      >
        <h1
          style="
            font-size: 3.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 0;
          "
        >
          Sign Up
        </h1>

        <p style="margin: 0; font-size: 1.5rem; text-align: center">
          Already have an account?
          <a href="/user/signin" class="sign-in-link">Log in</a>
        </p>
      </div>

      <form
        action="/user/signup"
        method="post"
        enctype="multipart/form-data"
        class="row g-3"
        style="
          max-width: 600px;
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto;
          inset: 0;
        "
        id="signupForm"
      >
        <div class="col-md-12">
          <label class="form-label" for="fullName">Full Name</label>
          <input
            type="text"
            name="fullName"
            id="fullName"
            class="form-control"
            autocomplete="name"
            placeholder="John Doe"
          />

          <% if (locals.zodErrors && locals.zodErrors.length > 0) { %>
          <div style="display: flex; flex-direction: column; gap: 0.5rem">
            <% locals.zodErrors.forEach((zodError) => { %> <% if
            (zodError.path[0] === 'fullName') { %>
            <p class="error-message"><%= zodError.message %></p>
            <% } %> <% }) %>
          </div>
          <% } %>
        </div>

        <div class="col-md-12">
          <label for="email" class="form-label">Email</label>
          <input
            type="email"
            class="form-control"
            id="email"
            name="email"
            placeholder="johndoe@gmail.com"
            autocomplete="email"
          />

          <% if (locals.zodErrors && locals.zodErrors.length > 0) { %>
          <div style="display: flex; flex-direction: column; gap: 0.5rem">
            <% locals.zodErrors.forEach((zodError) => { %> <% if
            (zodError.path[0] === 'email') { %>
            <p class="error-message"><%= zodError.message %></p>
            <% } %> <% }) %>
          </div>
          <% } %>
        </div>

        <div class="col-md-12" style="position: relative">
          <label for="password" class="form-label">Password</label>
          <input
            type="password"
            class="form-control"
            id="password"
            name="password"
            placeholder="8-digit password"
          />

          <div
            style="position: absolute; top: 0; right: 0; cursor: pointer"
            id="togglePassword"
          >
            <!-- Visible when password is hidden (default) – shows eye + "Show" -->
            <span
              id="showIcon"
              style="display: inline-flex; align-items: center; gap: 0.25rem"
            >
              <img
                src="/eye.svg"
                alt="Show password"
                style="width: 1.25rem; height: 1.25rem"
              />
              <span style="font-size: 1.125rem; font-weight: bold">Show</span>
            </span>
            <!-- Visible when password is visible – shows eye-off + "Hide" -->
            <span
              id="hideIcon"
              style="display: none; align-items: center; gap: 0.25rem"
            >
              <img
                src="/eye-off.svg"
                alt="Hide password"
                style="width: 1.25rem; height: 1.25rem"
              />
              <span style="font-size: 1.125rem; font-weight: bold">Hide</span>
            </span>
          </div>

          <% if (locals.zodErrors && locals.zodErrors.length > 0) { %>
          <div style="display: flex; flex-direction: column; gap: 0.125rem">
            <% locals.zodErrors.forEach((zodError) => { %> <% if
            (zodError.path[0] === 'password') { %>
            <p class="error-message"><%= zodError.message %></p>
            <% } %> <% }) %>
          </div>
          <% } else { %>
          <ul class="password-format">
            <li>One uppercase character [A-Z]</li>
            <li>One lowercase character [a-z]</li>
            <li>One number [0-9]</li>
            <li>8 characters minimum</li>
            <li>One special character [@, #, $, %, !, ^, &, *]</li>
          </ul>
          <% } %>
        </div>

        <div class="col-md-12">
          <label for="confirmPassword" class="form-label"
            >Confirm Password</label
          >
          <input
            type="password"
            class="form-control"
            id="confirmPassword"
            name="confirmPassword"
            placeholder="Re-enter your password"
          />

          <% if (locals.zodErrors && locals.zodErrors.length > 0) { %>
          <div style="display: flex; flex-direction: column; gap: 0.5rem">
            <% locals.zodErrors.forEach((zodError) => { %> <% if
            (zodError.path[0] === 'confirmPassword') { %>
            <p class="error-message"><%= zodError.message %></p>
            <% } %> <% }) %>
          </div>
          <% } %>
        </div>

        <div class="col-12">
          <label for="profileImage" class="form-label"
            >Select your profile image</label
          >
          <input
            type="file"
            class="form-control"
            id="profileImage"
            name="profileImage"
          />

          <% if (locals.zodErrors && locals.zodErrors.length > 0) { %>
          <div style="display: flex; flex-direction: column; gap: 0.5rem">
            <% locals.zodErrors.forEach((zodError) => { %> <% if
            (zodError.path[0] === 'profileImage') { %>
            <p class="error-message"><%= zodError.message %></p>
            <% } %> <% }) %>
          </div>
          <% } else { %>
          <p
            style="
              margin-block: 0.125rem 0;
              font-size: 1rem;
              font-style: italic;
            "
          >
            Maximum upload file size: 5 MB
          </p>
          <% } %>
        </div>

        <div class="col-12" style="margin-top: 1.5rem">
          <button type="submit" class="btn btn-primary">Sign up</button>
        </div>
      </form>
    </section>

    <%- include('./partials/scripts') %>
    <script>
      const togglePassword = document.getElementById("togglePassword");
      const password = document.getElementById("password");
      const confirmPassword = document.getElementById("confirmPassword");
      const showIcon = document.getElementById("showIcon");
      const hideIcon = document.getElementById("hideIcon");

      togglePassword.addEventListener("click", function () {
        if (password.type === "password") {
          password.type = "text";
          confirmPassword.type = "text";

          showIcon.style.display = "none";
          hideIcon.style.display = "inline-flex";
        } else {
          password.type = "password";
          confirmPassword.type = "password";

          showIcon.style.display = "inline-flex";
          hideIcon.style.display = "none";
        }
      });
    </script>
  </body>
</html>
